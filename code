import random
import string
import math

# Hangman ASCII art
HANGMAN_PICS = ['''
    +---+
         |
         |
         |
        ===''', '''
    +---+
    O   |
        |
        |
       ===''', '''
    +---+
    O   |
    |   |
        |
       ===''', '''
    +---+
    O   |
   /|   |
        |
       ===''', '''
    +---+
    O   |
   /|\  |
        |
       ===''', '''
    +---+
    O   |
   /|\  |
   /    |
       ===''', '''
    +---+
    O   |
   /|\  |
   / \  |
       ===''']

# Themes and words
themes = {
    "Animals": {
        "Easy": ['ant', 'cat', 'dog', 'bat', 'owl'],
        "Moderate": ['elephant', 'giraffe', 'hippo', 'lion', 'tiger'],
        "Hard": ['crocodile', 'gorilla', 'leopard', 'rhinoceros', 'zebra']
    },
    "Fruits": {
        "Easy": ['apple', 'banana', 'grape', 'kiwi', 'mango'],
        "Moderate": ['orange', 'peach', 'pear', 'pineapple', 'strawberry'],
        "Hard": ['blueberry', 'raspberry', 'watermelon', 'blackberry', 'pomegranate']
    },
    "Countries": {
        "Easy": ['brazil', 'canada', 'china', 'egypt', 'france'],
        "Moderate": ['india', 'japan', 'mexico', 'russia', 'spain'],
        "Hard": ['australia', 'germany', 'italy', 'netherlands', 'united kingdom']
    }
}

# Difficulty levels based on age
age_difficulty_levels = {
    "Child": "Easy",    # Simple words for children
    "Teen": "Moderate",   # Moderate words for teens
    "Adult": "Hard"  # Challenging words for adults
}

def get_age_group():
    while True:
        try:
            age = int(input("Enter your age: "))
            if age < 0:
                print("Please enter a valid age.")
            elif age <= 7:
                return "Child"
            elif age <= 13:
                return "Teen"
            else:
                return "Adult"
        except ValueError:
            print("Please enter a valid age.")

def select_theme(age_group):
    return ["Animals", "Fruits", "Countries"]

def select_word_difficulty(theme, difficulty):
    return random.choice(themes[theme][difficulty])

def display_board(missed_letters, correct_letters, secret_word):
    print(HANGMAN_PICS[len(missed_letters)])
    print("\nMissed letters:", " ".join(missed_letters))

    blanks = ""
    for letter in secret_word:
        if letter in correct_letters:
            blanks += letter + " "
        else:
            blanks += "_ "
    print("\n" + blanks)

def get_guess(already_guessed):
    while True:
        guess = input("Please guess a letter (or enter 'h' for a hint): ").lower()
        if len(guess) != 1:
            print("Only a single letter is allowed.")
        elif guess in already_guessed:
            print("You have already guessed that letter. Choose again.")
        elif guess not in string.ascii_lowercase and guess != 'h':
            print("Please enter a letter from the alphabet.")
        else:
            return guess

def play_again():
    return input("Would you like to play again? (y)es or (n)o: ").lower().startswith('y')

def get_hint(secret_word):
    return random.choice(secret_word)

def main():
    print("|_H_A_N_G_M_A_N_|")
    while True:
        age_group = get_age_group()
        available_themes = select_theme(age_group)

        print("Available themes:")
        for i, theme in enumerate(available_themes, 1):
            print(f"{i}. {theme}")

        theme_choice = int(input("Choose a theme (enter the corresponding number): "))
        selected_theme = available_themes[theme_choice - 1]

        word_difficulty = age_difficulty_levels[age_group]
        word = select_word_difficulty(selected_theme, word_difficulty)

        missed_letters = ""
        correct_letters = ""

        while True:
            display_board(missed_letters, correct_letters, word)
            guess = get_guess(missed_letters + correct_letters)

            if guess == 'h':
                num1 = random.randint(1, 10)
                num2 = random.randint(1, 10)
                operation = random.choice(['+', '-', '*'])
                problem = f"What is {num1} {operation} {num2}?"
                print(f"Solve this math problem to get a hint: {problem}")
                answer = eval(str(num1) + operation + str(num2))
                user_answer = input("Enter your answer: ")
                if user_answer == str(answer):
                    hint = get_hint(word)
                    print(f"Hint: The secret word includes the letter '{hint}'. Try it!")
                else:
                    print("Incorrect answer. Hint not provided.")
                continue

            if guess in word:
                correct_letters += guess
                all_letters_found = all(letter in correct_letters for letter in word)
                if all_letters_found:
                    print("You guessed it!")
                    print(f"The secret word is '{word}'! You win!")
                    break
            else:
                missed_letters += guess

            if len(missed_letters) == len(HANGMAN_PICS) - 1:
                display_board(missed_letters, correct_letters, word)
                print(f"You have run out of guesses! The word was '{word}'.")
                break

        if not play_again():
            break

if __name__ == "__main__":
    main()
